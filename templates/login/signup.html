{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TGZ | Registro</title>
    <link rel="stylesheet" href="{% static 'css/estilos_login.css' %}">
    <script src="https://kit.fontawesome.com/cd10d9582d.js" crossorigin="anonymous"></script>
</head>
<body class="login-base">

    <label class="ir">
        <input type="checkbox" class="toggle-neon">
        <i class="arriba fa-solid fa-angles-up" aria-label="Volver al inicio"></i>
    </label>

    <div class="login-container">

        {% if form %}
            {% for field in form %}
                {% for error in field.errors %}
                    <div style="color: red;">{{ error }}</div>
                {% endfor %}
            {% endfor %}
            {% for error in form.non_field_errors %}
                <div style="color: red;">{{ error }}</div>
            {% endfor %}
        {% endif %}

        <form method="post" enctype="multipart/form-data" id="registro-form">
            {% csrf_token %}
            <input type="checkbox" class="input-check" id="input-check">
            <label for="input-check"></label>

            <h2>Registro</h2>

            <!-- Usuario -->
            <div class="input-box">
                <span class="icon"><i class="fa-solid fa-user"></i></span>
                <input type="text" name="username" required value="{{ request.POST.username }}">
                <label>Usuario</label>
                <div class="input-line"></div>
            </div>

            <!-- Email -->
            <div class="input-box">
                <span class="icon"><i class="fa-solid fa-envelope"></i></span>
                <input type="email" name="email" required value="{{ request.POST.email }}">
                <label>Email</label>
                <div class="input-line"></div>
            </div>

            <!-- Contraseña -->
            <div class="input-box">
                <span class="icon"><i class="fa-solid fa-lock"></i></span>
                <input type="password" name="password" id="password" required>
                <label>Contraseña</label>
                <div class="input-line"></div>
            </div>

            <!-- Confirmar contraseña -->
            <div class="input-box">
                <span class="icon"><i class="fa-solid fa-lock"></i></span>
                <input type="password" name="confirmar_password" id="confirmar_password" required>
                <label>Confirmar Contraseña</label>
                <div class="input-line"></div>
            </div>

            <!-- Apellido -->
            <div class="input-box">
                <span class="icon"><i class="fa-solid fa-id-card"></i></span>
                <input type="text" name="apellido" value="{{ request.POST.apellido }}">
                <label>Apellido</label>
                <div class="input-line"></div>
            </div>

            <!-- Fecha de nacimiento -->
            <div class="input-box">
                <span class="icon"><i class="fa-solid fa-calendar-days"></i></span>
                <input type="date" name="fecha_nacimiento" value="{{ request.POST.apellido }}">
                <label style="top:-15px;">Fecha de nacimiento</label>
                <div class="input-line"></div>
            </div>

            <!-- Imagen -->
            <div class="input-box">
                <span class="icon"><i class="fa-solid fa-image"></i></span>
                <input type="file" name="imagen">
                <label style="top:-15px;">Imagen</label>
                <div class="input-line"></div>
            </div>

            <!-- Superusuario -->
            {% if request.user.is_staff %}
            <div class="remember-forgot">
                <label>
                    <input type="checkbox" name="is_superuser">
                    ¿Es superusuario?
                </label>
            </div>
            {% endif %}

            <button type="submit">Registrar</button>

            <div class="register-link">
                <p>¿Ya tenés cuenta? <a href="/login/signin/">Iniciar sesión</a></p>
            </div>

            {% if mensaje %}
                <div style="color:white;text-align:center;margin-top:10px">{{ mensaje }}</div>
            {% endif %}
        </form>
    </div>

    <!-- Validación visual -->
    <script>
        document.getElementById("registro-form").addEventListener("submit", function(e) {
            const pass = document.getElementById("password").value;
            const confirm = document.getElementById("confirmar_password").value;
            if (pass !== confirm) {
                alert("Las contraseñas no coinciden");
                e.preventDefault();
            }
        });
    </script>
    <script src="blog.js"></script>
</body>
</html>
